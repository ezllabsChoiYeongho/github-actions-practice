name: Push to PR

on:
  push:
    branches:
      - "design-token"

permissions: write-all

jobs:
  push-to-pr:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - name: Use Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "20.x"
          cache: "yarn"

      - name: install dependencies
        run: yarn --frozen-lockfile

      - name: build project
        run: yarn build

      - name: commit and push new changes to design-token branch
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "chore: 토큰 빌드 결과물 업데이트"

  pull-request:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: create pull request
        continue-on-error: true
        run: gh pr create -B design-token -H design-system-token-push --title "테스트 PR" --body "테스트 PR for Token Studio"
        # run: |
        #   curl -L \
        #   -X POST \
        #   -H "Accept: application/vnd.github+json" \
        #   -H "Authorization: Bearer ${{secrets.GITHUB_TOKEN}}" \
        #   -H "X-GitHub-Api-Version: 2022-11-28" \
        #   https://api.github.com/repos/ezllabsChoiYeongho/github-actions-practice/pulls \
        #   -d '{"title":"디자인 토큰 변경","body":"# Primary Color 변경","head":"design-system-token-push","base":"design-token"}'
        #
        env:
          GITHUB_TOKEN: ${{ secrets.ACCESS_TOKEN }}
